# Xboard-Mihomo é¡¹ç›®ä¿®æ”¹æ€»ç»“

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. åŸŸåé…ç½®ä¿®æ”¹
å·²å°†æ‰€æœ‰ `smartelectro.eu.org` æ›¿æ¢ä¸º `vip8888.dpdns.org`

**ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
- `assets/config/xboard.config.yaml` - ä¸»é…ç½®æ–‡ä»¶
- `config.json` - JSON é…ç½®æ–‡ä»¶

**ä¿®æ”¹å†…å®¹ï¼š**
- `app.siteUrl`: `https://vip8888.dpdns.org`
- `app.apiBaseUrl`: `https://vip8888.dpdns.org`
- `panels.mihomo[0].url`: `https://vip8888.dpdns.org`
- `subscription.urls[0].url`: `https://vip8888.dpdns.org`
- `update[0].url`: `https://vip8888.dpdns.org`
- `onlineSupport[0].url`: `https://vip8888.dpdns.org`
- `onlineSupport[0].apiBaseUrl`: `https://vip8888.dpdns.org`

### 2. å®¢æˆ·ç«¯åç§°ä¿®æ”¹
å·²å°†åº”ç”¨åç§°ä» "Flclash" æ”¹ä¸º "ç« é±¼æœºåœº"

**ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
- `lib/common/constant.dart` - `appName` å’Œ `appNameEn`
- `distribute_options.yaml` - `app_name`
- `setup.dart` - `Build.appName`
- `android/app/src/main/res/values/strings.xml` - Android å­—ç¬¦ä¸²èµ„æº
- `android/app/src/main/AndroidManifest.xml` - Android åº”ç”¨æ ‡ç­¾ï¼ˆ2å¤„ï¼‰

**ä¿®æ”¹å†…å®¹ï¼š**
- `appName`: `"ç« é±¼æœºåœº"`
- `appNameEn`: `"ZhangYuAirport"` (ç”¨äº HTTP User-Agent)
- Android åº”ç”¨æ ‡ç­¾: `"ç« é±¼æœºåœº"`

### 3. Android æ„å»ºè­¦å‘Šä¿®å¤
å°† `compileSdk` ä» 35 å‡çº§åˆ° 36ï¼Œè§£å†³æ’ä»¶è¦æ±‚æ›´é«˜ SDK ç‰ˆæœ¬çš„è­¦å‘Š

**ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
- `android/app/build.gradle.kts`

**ä¿®æ”¹å†…å®¹ï¼š**
```kotlin
compileSdk = 36  // ä» 35 å‡çº§åˆ° 36
```

## âš ï¸ é»‘å±é—®é¢˜åˆ†æ

### å¯èƒ½çš„åŸå› 

æ ¹æ® `lib/main.dart` çš„å¯åŠ¨æµç¨‹åˆ†æï¼Œé»‘å±é—®é¢˜å¯èƒ½ç”±ä»¥ä¸‹åŸå› å¯¼è‡´ï¼š

#### 1. é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥
- **ä½ç½®**: `_initializeXBoardServices()` å‡½æ•°
- **åŸå› **: å¦‚æœ `assets/config/xboard.config.yaml` æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ ¼å¼é”™è¯¯ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸
- **è§£å†³**: ç¡®ä¿é…ç½®æ–‡ä»¶å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®

#### 2. åŸŸåè¿æ¥è¶…æ—¶
- **ä½ç½®**: `ConfigFileLoader.loadFromFile()` æˆ–åŸŸåç«é€ŸæœåŠ¡
- **åŸå› **: åº”ç”¨å¯åŠ¨æ—¶å¯èƒ½å°è¯•è¿æ¥åŸŸåï¼Œå¦‚æœç½‘ç»œä¸é€šæˆ–åŸŸåä¸å¯è¾¾ï¼Œå¯èƒ½å¯¼è‡´åˆå§‹åŒ–å¡ä½
- **è§£å†³**: 
  - æ£€æŸ¥ `https://vip8888.dpdns.org` æ˜¯å¦å¯è®¿é—®
  - æ£€æŸ¥ç½‘ç»œè¿æ¥
  - æŸ¥çœ‹ `setup_android.log` å’Œ `build_android.log` ä¸­çš„é”™è¯¯ä¿¡æ¯

#### 3. SDK åˆå§‹åŒ–å¤±è´¥
- **ä½ç½®**: `XBoardSDK.instance` åˆå§‹åŒ–
- **åŸå› **: SDK åˆå§‹åŒ–å¯èƒ½ä¾èµ–é…ç½®æ–‡ä»¶æˆ–ç½‘ç»œè¿æ¥
- **è§£å†³**: æ£€æŸ¥ SDK åˆå§‹åŒ–æ—¥å¿—

#### 4. RemoteTaskManager åˆå§‹åŒ–å¤±è´¥
- **ä½ç½®**: `RemoteTaskManager.create()` å’Œ `initialize()`
- **åŸå› **: WebSocket è¿æ¥å¤±è´¥å¯èƒ½å¯¼è‡´åˆå§‹åŒ–å¼‚å¸¸
- **è§£å†³**: ä»£ç ä¸­å·²æœ‰ try-catchï¼Œä½†éœ€è¦æ£€æŸ¥æ—¥å¿—

### æ’æŸ¥å»ºè®®

1. **æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶**
   - `setup_android.log` - æŸ¥çœ‹åˆå§‹åŒ–è¿‡ç¨‹ä¸­çš„é”™è¯¯
   - `build_android.log` - æŸ¥çœ‹æ„å»ºè¿‡ç¨‹ä¸­çš„è­¦å‘Šå’Œé”™è¯¯
   - ä½¿ç”¨ `adb logcat` æŸ¥çœ‹è¿è¡Œæ—¶æ—¥å¿—

2. **æ£€æŸ¥é…ç½®æ–‡ä»¶**
   ```bash
   # ç¡®ä¿é…ç½®æ–‡ä»¶å­˜åœ¨
   ls -la assets/config/xboard.config.yaml
   
   # éªŒè¯ YAML æ ¼å¼
   cat assets/config/xboard.config.yaml
   ```

3. **æµ‹è¯•åŸŸåè¿æ¥**
   ```bash
   # æµ‹è¯•åŸŸåæ˜¯å¦å¯è®¿é—®
   curl -I https://vip8888.dpdns.org
   ```

4. **æ£€æŸ¥ Android æƒé™**
   - ç¡®ä¿åº”ç”¨æœ‰ `INTERNET` æƒé™ï¼ˆå·²åœ¨ AndroidManifest.xml ä¸­é…ç½®ï¼‰
   - æ£€æŸ¥æ˜¯å¦æœ‰ç½‘ç»œå®‰å…¨é…ç½®é˜»æ­¢äº†è¿æ¥

5. **ä½¿ç”¨è°ƒè¯•æ¨¡å¼æ„å»º**
   - æ„å»º debug ç‰ˆæœ¬è¿›è¡Œæµ‹è¯•
   - ä½¿ç”¨ `flutter run` æŸ¥çœ‹å®æ—¶æ—¥å¿—

### å»ºè®®çš„ä¿®å¤æ­¥éª¤

1. **éªŒè¯åŸŸåå¯è®¿é—®æ€§**
   - åœ¨æµè§ˆå™¨ä¸­è®¿é—® `https://vip8888.dpdns.org`
   - ç¡®è®¤ API ç«¯ç‚¹æ­£å¸¸å“åº”

2. **æ£€æŸ¥é…ç½®æ–‡ä»¶**
   - ç¡®è®¤ `xboard.config.yaml` æ ¼å¼æ­£ç¡®
   - ç¡®è®¤æ‰€æœ‰å¿…éœ€çš„é…ç½®é¡¹éƒ½å·²å¡«å†™

3. **æ·»åŠ é”™è¯¯å¤„ç†**
   - åœ¨ `main.dart` çš„ `_initializeXBoardServices()` ä¸­æ·»åŠ æ›´è¯¦ç»†çš„é”™è¯¯æ—¥å¿—
   - è€ƒè™‘æ·»åŠ è¶…æ—¶æœºåˆ¶ï¼Œé¿å…æ— é™ç­‰å¾…

4. **æµ‹è¯•æ„å»º**
   - ä½¿ç”¨ GitHub Actions é‡æ–°æ„å»º
   - æŸ¥çœ‹æ„å»ºæ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

## ğŸ“ GitHub Actions æ„å»ºè¯´æ˜

é¡¹ç›®ä½¿ç”¨ GitHub Actions è¿›è¡Œè‡ªåŠ¨æ„å»ºï¼Œé…ç½®æ–‡ä»¶ï¼š
- `.github/workflows/build.yaml` - ä¸»æ„å»ºæµç¨‹ï¼ˆæ ‡ç­¾è§¦å‘ï¼‰
- `.github/workflows/build-android-win.yml` - Android æ„å»ºæµç¨‹ï¼ˆpush åˆ° main/master åˆ†æ”¯è§¦å‘ï¼‰

### æ„å»ºæ­¥éª¤
1. æ£€æŸ¥ä»£ç 
2. è®¾ç½® Flutter ç¯å¢ƒ
3. å®‰è£…ä¾èµ– (`flutter pub get`)
4. ç”Ÿæˆä»£ç  (`dart run build_runner`)
5. è¿è¡Œ setup (`dart run setup.dart android`)
6. æ„å»º APK (`flutter build apk --release`)

### æ³¨æ„äº‹é¡¹
- æ„å»ºæ—¥å¿—ä¼šè‡ªåŠ¨ä¸Šä¼ ä¸º Artifacts
- å¦‚æœæ„å»ºå¤±è´¥ï¼Œæ£€æŸ¥ `setup_android.log` å’Œ `build_android.log`
- ç¡®ä¿ GitHub Secrets ä¸­é…ç½®äº†ç­¾åå¯†é’¥ï¼ˆå¦‚æœä½¿ç”¨ release ç­¾åï¼‰

## ğŸ”„ ä¸‹ä¸€æ­¥æ“ä½œ

1. **æäº¤ä¿®æ”¹åˆ° GitHub**
   ```bash
   git add .
   git commit -m "ä¿®æ”¹åŸŸåå’Œå®¢æˆ·ç«¯åç§°ï¼Œä¿®å¤ Android æ„å»ºè­¦å‘Š"
   git push
   ```

2. **è§¦å‘ GitHub Actions æ„å»º**
   - æ¨é€åˆ° main/master åˆ†æ”¯ä¼šè‡ªåŠ¨è§¦å‘ Android æ„å»º
   - æˆ–åˆ›å»ºæ ‡ç­¾è§¦å‘å®Œæ•´æ„å»ºæµç¨‹

3. **æµ‹è¯•æ„å»ºç»“æœ**
   - ä¸‹è½½æ„å»ºçš„ APK
   - å®‰è£…åˆ°è®¾å¤‡æµ‹è¯•
   - æŸ¥çœ‹æ˜¯å¦è¿˜æœ‰é»‘å±é—®é¢˜

4. **å¦‚æœä»æœ‰é»‘å±é—®é¢˜**
   - æŸ¥çœ‹è¿è¡Œæ—¶æ—¥å¿— (`adb logcat | grep -i flutter`)
   - æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®åŠ è½½
   - æ£€æŸ¥ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

